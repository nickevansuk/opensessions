'use strict';
const uuid = require('node-uuid');

module.exports = {
  up: (migration, Sequelize) => migration
    .createTable('Activities', {
      uuid: {
        type: Sequelize.UUID,
        defaultValue: Sequelize.UUIDV1,
        primaryKey: true
      },
      name: Sequelize.STRING,
    }))
    .then(() => migration.addColumn('Sessions', 'ActivityUuid', { type: Sequelize.UUID, allowNull: true, references: { model: 'Activities', key: 'uuid' } }))
    .then(() => {
      // source: https://en.wikipedia.org/w/index.php?title=Template:International_Sports_Federations&oldid=733950934
      // naive parsing: $('#wpTextbox1').html().split("\n").map(line => line.match(/\(.*\)/g)).filter(a => a).map(matches => matches[0]).map(sport => sport.replace(/[\(\)]/g, '')).map(name => name.split(' ').map(word => `${word.charAt(0).toUpperCase()}${word.slice(1)}`).join(' '))
      const activities = [
        'Aquatic Sports',
        'Archery',
        'Athletics',
        'Badminton',
        'Basketball',
        'Boxing',
        'Canoeing',
        'Cycling',
        'Equestrianism',
        'Fencing',
        'Field Hockey',
        'Football',
        'Golf',
        'Gymnastics',
        'Handball',
        'Judo',
        'Modern Pentathlon',
        'Rowing',
        'Rugby',
        'Sailing',
        'Table Tennis',
        'Taekwondo',
        'Tennis',
        'Triathlon',
        'Volleyball',
        'Weightlifting',
        'Wrestling',
        'Biathlon',
        'Bobsleigh And Skeleton',
        'Curling',
        'Ice Hockey',
        'Luge',
        'Skating Sports',
        'Skiing Sports',
        'Air Sports',
        'American Football',
        'Auto Racing',
        'Bandy',
        'Baseball And Softball',
        'Basque Pelota',
        'Billiard Sports',
        'Boules',
        'Bowling',
        'Bridge',
        'Chess',
        'Cricket',
        'Dance Sport',
        'Floorball',
        'Flying Disc',
        'Karate',
        'Korfball',
        'Life Saving',
        'Motorcycle Sport',
        'Mountaineering',
        'Netball',
        'Orienteering',
        'Polo',
        'Powerboating',
        'Racquetball',
        'Roller Sports',
        'Ski Mountaineering',
        'Sports Climbing',
        'Squash',
        'Sumo',
        'Surfing',
        'Tug-of-war',
        'Underwater Sports',
        'Waterski And Wakeboard',
        'Wushu',
        'Aikido',
        'Body Building',
        'Casting',
        'Cheer',
        'Darts',
        'Dragon Boat',
        'Draughts',
        'Fistball',
        'Go',
        'Ice Stock Sport',
        'Ju-jitsu',
        'Kendo',
        'Kickboxing',
        'Lacrosse',
        'Minigolf',
        'Muay Thai',
        'Powerlifting',
        'Sambo',
        'Savate',
        'Sepaktakraw',
        'Sleddog',
        'Soft Tennis',
        'Sport Fishing',
        'Arm Wrestling',
        'Australian Rules Football',
        'Bodyboarding',
        'Bowls',
        'Broomball',
        'Croquet',
        'Kabaddi',
        'Mixed Martial Arts',
        'Padel',
        'Poker',
        'Quidditch',
        'Radio-controlled Racing',
        'Ringette',
        'Rogaining',
        'Rugby League',
        'Sport Stacking',
        'Tent Pegging',
        'Touch Football'
      ];
      return migration.bulkInsert('Activities', activities.map(name => ({
        uuid: uuid.v1(),
        name
      })));
    }),
  down: (migration) => migration.removeColumn('Sessions', 'ActivityUuid')
    .then(() => migration.dropTable('Activities'))
};
